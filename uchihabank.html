<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>UCHIHA BANK</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        background: #f5f9ff;
    }
    /* Intro screen */
    #intro {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        font-size: 3em;
        font-weight: bold;
        color: #007bff;
        background: white;
    }
    /* Login screen */
    #login-section {
        display: none;
        height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
    }
    #login-section h1 {
        color: #007bff;
        margin-bottom: 20px;
    }
    .top-right-btn {
        position: absolute;
        top: 20px;
        right: 20px;
        background: #007bff;
        color: white;
        padding: 8px 15px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
    .login-box {
        background: white;
        padding: 20px;
        display: inline-block;
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(0,0,0,0.1);
        text-align: center;
    }
    .login-box h2 {
        margin-bottom: 15px;
        color: #007bff;
    }
    .login-box input {
        display: block;
        margin: 10px auto;
        padding: 10px;
        width: 200px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }
    .login-box button {
        background: #007bff;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
    /* Panels */
    header {
        background: #007bff;
        color: white;
        padding: 10px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    main {
        padding: 20px;
    }
    .hidden {
        display: none;
    }
    /* Popup */
    .popup {
        display: none;
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: rgba(0,0,0,0.4);
        align-items: center;
        justify-content: center;
    }
    .popup-content {
        background: white;
        padding: 20px;
        border-radius: 10px;
        min-width: 300px;
    }
    .popup-content input {
        width: 100%;
        margin: 5px 0;
        padding: 8px;
    }
</style>
</head>
<body>

<div id="intro">UCHIHA BANK</div>

<div id="login-section">
    <button id="toggle-login" class="top-right-btn">Admin Login</button>
    <h1>UCHIHA BANK</h1>
    <div class="login-box">
        <h2 id="login-panel-title">User Login</h2>
        <input type="text" id="login-username" placeholder="Username">
        <input type="password" id="login-password" placeholder="Password">
        <button onclick="login()">Login</button>
    </div>
</div>

<!-- User Panel -->
<div id="user-panel" class="hidden">
    <header>
        <span>User Panel</span>
        <button onclick="logout()">Logout</button>
    </header>
    <main>
        <p><b>Balance:</b> $<span id="user-balance">0</span></p>
        <input type="number" id="amount" placeholder="Amount">
        <input type="text" id="message" placeholder="Message">
        <button onclick="requestTransaction('deposit')">Deposit</button>
        <button onclick="requestTransaction('withdraw')">Withdraw</button>
    </main>
</div>

<!-- Admin Panel -->
<div id="admin-panel" class="hidden">
    <header>
        <span>Admin Panel</span>
        <button onclick="logout()">Logout</button>
    </header>
    <main>
        <h3>Users</h3>
        <button onclick="openPopup()">Add User</button>
        <table border="1" cellpadding="5" cellspacing="0" width="100%" id="user-table">
            <tr><th>ID</th><th>Username</th><th>Password</th><th>Balance</th><th>Action</th></tr>
        </table>

        <h3>Deposit Requests</h3>
        <ul id="deposit-requests"></ul>

        <h3>Withdraw Requests</h3>
        <ul id="withdraw-requests"></ul>
    </main>
</div>

<!-- Popup -->
<div class="popup" id="user-popup">
    <div class="popup-content">
        <h3 id="popup-title">Add User</h3>
        <input type="text" id="popup-id" placeholder="ID">
        <input type="text" id="popup-username" placeholder="Username">
        <input type="text" id="popup-password" placeholder="Password">
        <input type="number" id="popup-balance" placeholder="Balance">
        <button onclick="saveUser()">Save</button>
        <button onclick="closePopup()">Cancel</button>
    </div>
</div>

<script>
let isAdmin = false;
let currentUser = null;
let users = JSON.parse(localStorage.getItem('users')) || [];
let depositRequests = [];
let withdrawRequests = [];
let editIndex = null;

function showIntro() {
    setTimeout(() => {
        document.getElementById('intro').style.display = 'none';
        document.getElementById('login-section').style.display = 'flex';
    }, 2000);
}
showIntro();

document.getElementById('toggle-login').onclick = function() {
    isAdmin = !isAdmin;
    document.getElementById('login-panel-title').textContent = isAdmin ? 'Admin Login' : 'User Login';
    this.textContent = isAdmin ? 'User Login' : 'Admin Login';
};

function login() {
    let username = document.getElementById('login-username').value;
    let password = document.getElementById('login-password').value;
    if (isAdmin) {
        if (username === 'admin' && password === 'admin123') {
            document.getElementById('login-section').style.display = 'none';
            document.getElementById('admin-panel').classList.remove('hidden');
            loadUsers();
        } else {
            alert('Invalid admin credentials');
        }
    } else {
        let user = users.find(u => u.username === username && u.password === password);
        if (user) {
            currentUser = user;
            document.getElementById('login-section').style.display = 'none';
            document.getElementById('user-panel').classList.remove('hidden');
            document.getElementById('user-balance').textContent = user.balance;
        } else {
            alert('Invalid user credentials');
        }
    }
}

function logout() {
    document.getElementById('user-panel').classList.add('hidden');
    document.getElementById('admin-panel').classList.add('hidden');
    document.getElementById('login-section').style.display = 'flex';
    document.getElementById('login-username').value = '';
    document.getElementById('login-password').value = '';
}

function requestTransaction(type) {
    let amount = parseFloat(document.getElementById('amount').value);
    let message = document.getElementById('message').value;
    if (isNaN(amount) || amount <= 0) {
        alert('Invalid amount');
        return;
    }
    if (type === 'deposit') {
        depositRequests.push({ user: currentUser.username, amount, message });
    } else {
        withdrawRequests.push({ user: currentUser.username, amount, message });
    }
    alert('Request sent to admin');
    document.getElementById('amount').value = '';
    document.getElementById('message').value = '';
    saveData();
}

function loadUsers() {
    let table = document.getElementById('user-table');
    table.innerHTML = '<tr><th>ID</th><th>Username</th><th>Password</th><th>Balance</th><th>Action</th></tr>';
    users.forEach((u, i) => {
        table.innerHTML += `<tr>
            <td>${u.id}</td>
            <td>${u.username}</td>
            <td>${u.password}</td>
            <td>${u.balance}</td>
            <td><button onclick="editUser(${i})">‚úè</button></td>
        </tr>`;
    });
    renderRequests();
}

function renderRequests() {
    document.getElementById('deposit-requests').innerHTML = depositRequests.map((r, i) =>
        `<li>${r.user} requests deposit $${r.amount} (${r.message}) 
         <button onclick="approveRequest('deposit',${i})">Approve</button>
         <button onclick="rejectRequest('deposit',${i})">Reject</button></li>`).join('');
    document.getElementById('withdraw-requests').innerHTML = withdrawRequests.map((r, i) =>
        `<li>${r.user} requests withdraw $${r.amount} (${r.message}) 
         <button onclick="approveRequest('withdraw',${i})">Approve</button>
         <button onclick="rejectRequest('withdraw',${i})">Reject</button></li>`).join('');
}

function approveRequest(type, index) {
    let req = type === 'deposit' ? depositRequests[index] : withdrawRequests[index];
    let user = users.find(u => u.username === req.user);
    if (type === 'deposit') {
        user.balance += req.amount;
        depositRequests.splice(index, 1);
    } else {
        if (user.balance >= req.amount) {
            user.balance -= req.amount;
            withdrawRequests.splice(index, 1);
        } else {
            alert('Insufficient balance');
            return;
        }
    }
    saveData();
    loadUsers();
}

function rejectRequest(type, index) {
    if (type === 'deposit') depositRequests.splice(index, 1);
    else withdrawRequests.splice(index, 1);
    saveData();
    renderRequests();
}

function openPopup() {
    editIndex = null;
    document.getElementById('popup-title').textContent = 'Add User';
    document.getElementById('popup-id').value = '';
    document.getElementById('popup-username').value = '';
    document.getElementById('popup-password').value = '';
    document.getElementById('popup-balance').value = '';
    document.getElementById('user-popup').style.display = 'flex';
}

function editUser(index) {
    editIndex = index;
    let u = users[index];
    document.getElementById('popup-title').textContent = 'Edit User';
    document.getElementById('popup-id').value = u.id;
    document.getElementById('popup-username').value = u.username;
    document.getElementById('popup-password').value = u.password;
    document.getElementById('popup-balance').value = u.balance;
    document.getElementById('user-popup').style.display = 'flex';
}

function saveUser() {
    let id = document.getElementById('popup-id').value;
    let username = document.getElementById('popup-username').value;
    let password = document.getElementById('popup-password').value;
    let balance = parseFloat(document.getElementById('popup-balance').value) || 0;
    if (!id || !username || !password) {
        alert('Fill all fields');
        return;
    }
    if (editIndex === null) {
        users.push({ id, username, password, balance });
    } else {
        users[editIndex] = { id, username, password, balance };
    }
    closePopup();
    saveData();
    loadUsers();
}

function closePopup() {
    document.getElementById('user-popup').style.display = 'none';
}

function saveData() {
    localStorage.setItem('users', JSON.stringify(users));
}
</script>
</body>
</html>